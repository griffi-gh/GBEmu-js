<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Gameboy</title>
	<link rel="shortcut icon" href="/favicon.ico">
	<link rel="icon" type="image/png" href="/favicon.png">
	<link rel="stylesheet" href="/index.css">
	<script type="module">
		import {Gameboy} from './gb/index.js';

		function button(id, fn) {
			const btn = document.getElementById(id);
			btn.onclick = () => { fn(btn); };
			btn.style.cssText += `width: ${(btn.getBoundingClientRect().width + 10).toString()}px !important;`;
			return btn;
		}
		function newGameboy() {
			return new Gameboy("gb-canvas");
		}

		let gb = newGameboy();

		let btn_step = button("btn-step", () => {
			gb.step();
		});
		let btn_pause =button("btn-pause", (btn) => { 
			if(gb.paused) {
				gb.resume();
			} else {
				gb.pause();
			}
			btn.textContent = gb.paused ? 'Play' : 'Pause';
		});
		let btn_reset = button("btn-reset", (btn) => {
			console.clear(); 
			gb = newGameboy();
			const OK = 'OK!';
			let orig = btn.textContent;
			if(orig!==OK) {
				btn.textContent = OK;
				setTimeout(() => { btn.textContent = orig; }, 1000)
			}
			btn_pause.textContent = 'Play';
		});
		

	</script>
</head>
<body>
	<div id="gb-wrapper"> 
		<canvas id="gb-canvas"></canvas><!--
		--><div>
			<button id="btn-step">Step</button>
			<button id="btn-pause">Play</button>
			<button id="btn-reset">Reset</button>
		</div>
	</div>
</body>
</html>